spec_text: |
  # File 4: inf_conformance.yml (Phần III-V-VI – 52 ID, Cover Infrastructure/Conformance/Phụ Lục)
  - id: INF-SAG-001
    title: Mô hình Kiến trúc - Áp dụng Saga, hiện thực hóa Google Cloud Workflows hoặc LangChain CrewAI (multi-agent teams, MCP streamable May 8 2025) hoặc Langroid MAP (delegation Sep 2025)
    spec_ref: Phần III §1
    doc_cite: MD:L157
    acceptance:
      tests: ["tests/inf/test_saga.py::test_architecture_workflows_crewai"]
      code_markers: ["@req:INF-SAG-001"]
      runtime_assertions: []
  - id: INF-SAG-002
    title: Saga integration with CrewAI MCP streamable
    spec_ref: Phần III §1
    doc_cite: MD:L157
    acceptance:
      tests: ["tests/inf/test_saga.py::test_crewai_mcp"]
      code_markers: ["@req:INF-SAG-002"]
      runtime_assertions: []
  - id: INF-AGENT-001
    title: Hệ thống Agent Chuyên biệt - Process Agent, Data Agent, Verifier Agent, Notifier Agent
    spec_ref: Phần III §2
    doc_cite: MD:L159
    acceptance:
      tests: ["tests/inf/test_agents.py::test_specialized_process_data_verifier_notifier"]
      code_markers: ["@req:INF-AGENT-001"]
      runtime_assertions: []
  - id: INF-AGENT-002
    title: Specialized agents delegation test (Langroid MAP Sep 2025)
    spec_ref: Phần III §2
    doc_cite: MD:L159
    acceptance:
      tests: ["tests/inf/test_agents.py::test_delegation_map"]
      code_markers: ["@req:INF-AGENT-002"]
      runtime_assertions: []
  - id: INF-VER-001
    title: Hợp đồng Bằng chứng Xác minh - Verifier Agent trả về {artifact_uri, artifact_hash, content_type, evidence_ts, source_kind (SHOULD standard values like agent_log/database/external_api)}; enum suggested
    spec_ref: Phần III §3
    doc_cite: MD:L129
    acceptance:
      tests: ["tests/inf/test_verifier.py::test_artifact_contract_source_kind"]
      code_markers: ["@req:INF-VER-001"]
      runtime_assertions: []
  - id: INF-VER-002
    title: Gate Independent Verification - Không coi nhiệm vụ hoàn thành nếu thiếu artifact theo hợp đồng Verifier
    spec_ref: Phần III §3 + Phần I §6
    doc_cite: MD:L129 + L17
    acceptance:
      tests: ["tests/inf/test_verifier.py::test_gate_no_artifact_fail"]
      code_markers: ["@req:INF-VER-002"]
      runtime_assertions: ["fail done without artifact"]
  - id: INF-VER-003
    title: Verifier source_kind standard values test (SHOULD enum)
    spec_ref: Phần III §3
    doc_cite: MD:L129
    acceptance:
      tests: ["tests/inf/test_verifier.py::test_source_kind_standard"]
      code_markers: ["@req:INF-VER-003"]
      runtime_assertions: []
  - id: INF-IMP-001
    title: Các Service Chuẩn hóa - /healthz, /readyz, /evidence/{job_id}
    spec_ref: Phần V §1
    doc_cite: MD:L163
    acceptance:
      tests: ["tests/inf/test_services.py::test_health_ready_evidence"]
      code_markers: ["@req:INF-IMP-001"]
      runtime_assertions: []
  - id: INF-IMP-002
    title: /evidence/{job_id} artifact validation
    spec_ref: Phần V §1
    doc_cite: MD:L163
    acceptance:
      tests: ["tests/inf/test_services.py::test_evidence_artifact"]
      code_markers: ["@req:INF-IMP-002"]
      runtime_assertions: []
  - id: INF-CAP-001
    title: /mcp/capabilities - Công bố envelope_versions, actions (kèm action_version/max_payload_bytes), transports, supported_encryption_schemes ["JWE", "AES-GCM"]; thêm /acp/capabilities cho merger ACP-A2A
    spec_ref: Phần V §2
    doc_cite: MD:L166-L171
    acceptance:
      tests: ["tests/inf/test_capabilities.py::test_mcp_acp_endpoints_encryption"]
      code_markers: ["@req:INF-CAP-001"]
      runtime_assertions: []
  - id: INF-CAP-002
    title: /mcp/capabilities completeness test (actions/version/bytes/transports/encryption)
    spec_ref: Phần V §2
    doc_cite: MD:L166-L171
    acceptance:
      tests: ["tests/inf/test_capabilities.py::test_completeness_encryption"]
      code_markers: ["@req:INF-CAP-002"]
      runtime_assertions: []
  - id: INF-CAP-003
    title: /mcp/capabilities eta support - Công bố supports_event_eta: true|false & retry_after_policy: ["rate_limit","eta"]
    spec_ref: Phần V §2
    doc_cite: MD:L166-L171
    acceptance:
      tests: ["tests/inf/test_capabilities.py::test_eta_support_flags"]
      code_markers: ["@req:INF-CAP-003"]
      runtime_assertions: []
  - id: INF-REG-001
    title: Capability Registry trung tâm - Agent Data duy trì registry liệt kê actions/action_version/transports/max_payload_bytes/supported_encryption_schemes; /mcp/capabilities MUST khớp registry (CI so khớp)
    spec_ref: Phần V (THÊM MỚI Registry)
    doc_cite: MD:L166-L171
    acceptance:
      tests: ["tests/inf/test_registry.py::test_actions_version_encryption_match_ci"]
      code_markers: ["@req:INF-REG-001"]
      runtime_assertions: []
  - id: INF-REG-002
    title: Heartbeat - Mỗi agent gửi
